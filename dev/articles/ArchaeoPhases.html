<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manual • ArchaeoPhases</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Manual">
<meta property="og:description" content="ArchaeoPhases">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArchaeoPhases</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ArchaeoPhases.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ArchaeoStat/ArchaeoPhases/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ArchaeoPhases_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Manual</h1>
                        <h4 class="author">A. Philippe, M.-A. Vibet</h4>
            
            <h4 class="date">2021-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ArchaeoStat/ArchaeoPhases/blob/master/vignettes/ArchaeoPhases.Rmd"><code>vignettes/ArchaeoPhases.Rmd</code></a></small>
      <div class="hidden name"><code>ArchaeoPhases.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><strong>ArchaeoPhases</strong> provides a list of functions for the statistical analysis of archaeological dates and groups of dates. It is based on the post-processing of the Markov Chains whose stationary distribution is the posterior distribution of a series of dates. Such MCMC output can be simulated by different applications as for instance <a href="https://chronomodel.com/">ChronoModel</a> <span class="citation">(Lanos et al. 2020)</span>, <a href="https://c14.arch.ox.ac.uk/oxcal.html">Oxcal</a> <span class="citation">(Bronk Ramsey 2009)</span> or <a href="https://bcal.shef.ac.uk/">BCal</a> <span class="citation">(Buck, Christen, and James 1999)</span>. The only requirement is to have a CSV file containing a sample from the posterior distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ArchaeoPhases</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="importing-data-into-r" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-data-into-r" class="anchor"></a>Importing data into R</h1>
<p><strong>To use ArchaeoPhases, the date format of the MCMC samples has to be in calendar BC/AD year.</strong></p>
<div id="import-data-from-chronomodel" class="section level2">
<h2 class="hasAnchor">
<a href="#import-data-from-chronomodel" class="anchor"></a>Import data from ‘ChronoModel’</h2>
<p>Two different files are generated by ChronoModel: <code>events.csv</code> that contains the MCMC samples of each event created in the modeling, and <code>phases.csv</code> that contains all the MCMC samples of the minimum and the maximum of each group of dates if at least one group is created.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_zip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/chronomodel.zip"</span>, package <span class="op">=</span> <span class="st">"ArchaeoPhases"</span><span class="op">)</span>
<span class="va">path_csv</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span><span class="va">path_zip</span>, exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">chrono_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.html">read_chronomodel</a></span><span class="op">(</span><span class="va">path_csv</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">chrono_phases</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.html">read_chronomodel</a></span><span class="op">(</span><span class="va">path_csv</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div id="import-data-from-oxcal" class="section level2">
<h2 class="hasAnchor">
<a href="#import-data-from-oxcal" class="anchor"></a>Import data from ‘Oxcal’</h2>
<p>Oxcal generates a CSV file containing the MCMC samples of all parameters (dates, start and end of phases).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_zip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/oxcal.zip"</span>, package <span class="op">=</span> <span class="st">"ArchaeoPhases"</span><span class="op">)</span>
<span class="va">path_csv</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span><span class="va">path_zip</span>, exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">oxcal_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.html">read_oxcal</a></span><span class="op">(</span><span class="va">path_csv</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>IUP <span class="op">=</span> <span class="fl">3</span>, Ahmarian <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">17</span>, UP <span class="op">=</span> <span class="fl">20</span><span class="op">:</span><span class="fl">22</span>, EPI <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">oxcal_phases</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phase.html">phase</a></span><span class="op">(</span><span class="va">oxcal_all</span>, groups <span class="op">=</span> <span class="va">p</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">oxcal_phases</span><span class="op">)</span>
<span class="co">#&gt; An object of class "PhasesMCMC"</span>
<span class="co">#&gt;   IUP_start  IUP_end Ahmarian_start Ahmarian_end UP_start   UP_end EPI_start</span>
<span class="co">#&gt; 1  -43967.2 -43967.2       -43444.3     -39711.5 -38503.0 -30389.4  -27843.4</span>
<span class="co">#&gt; 2  -43948.1 -43948.1       -43467.0     -39689.9 -38475.5 -30505.8  -27742.8</span>
<span class="co">#&gt; 3  -43836.2 -43836.2       -43405.6     -39727.4 -38475.5 -30505.8  -27746.9</span>
<span class="co">#&gt; 4  -43964.7 -43964.7       -43387.0     -39727.4 -38432.0 -30468.8  -27745.8</span>
<span class="co">#&gt; 5  -43876.7 -43876.7       -43387.0     -39727.4 -37765.7 -30468.8  -27781.3</span>
<span class="co">#&gt; 6  -43876.7 -43876.7       -43428.7     -39710.6 -37765.7 -30468.8  -27786.5</span>
<span class="co">#&gt;    EPI_end</span>
<span class="co">#&gt; 1 -27843.4</span>
<span class="co">#&gt; 2 -27742.8</span>
<span class="co">#&gt; 3 -27746.9</span>
<span class="co">#&gt; 4 -27745.8</span>
<span class="co">#&gt; 5 -27781.3</span>
<span class="co">#&gt; 6 -27786.5</span>
<span class="co">#&gt; Slot "start":</span>
<span class="co">#&gt; [1] 1 3 5 7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "end":</span>
<span class="co">#&gt; [1] 2 4 6 8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "ordered":</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "phases":</span>
<span class="co">#&gt; [1] "IUP"      "Ahmarian" "UP"       "EPI"     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "calendar":</span>
<span class="co">#&gt; [1] "BCAD"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "hash":</span>
<span class="co">#&gt; [1] "c609886312053fdd4f3488415f3b079f60f3f8d67fdc9c0ce34f30ee92960012"</span></code></pre></div>
</div>
</div>
<div id="convergence-of-mcmc-chains" class="section level1">
<h1 class="hasAnchor">
<a href="#convergence-of-mcmc-chains" class="anchor"></a>Convergence of MCMC chains</h1>
<p>Let’s use the data of Ksar Akil generated by ChronoModel <span class="citation">(Bosch et al. 2015)</span>. For a more detail on the diagnostic of Markov chain, see <span class="citation">Robert and Casella (2010)</span>.</p>
<p>To assess the agreement between the posterior distributions and the numerical approximations, three Markov chains were run in parallel by ‘ChronoModel’. For each chain, 1 000 iterations were used during the Burn-in period, 20 batches of 500 iterations were used in the Adapt period, 100 000 iterations were drawn in the Acquire period by only 1 out of 10 were kept in order to break the correlation structure.</p>
<p>From the analysis of the history plot, all Markov chains reach their equilibrium before the Acquire period. The autocorrelations of the three Markov chains are not significant, meaning the rate of subsample (1 over 10) is enough.</p>
<p>Now, using the package <strong>ArchaeoPhases</strong> and the package <strong>coda</strong>, we can verify whether the MCMC samples are correctly generated by the software. Indeed, the MCMC samples should have no autocorrelation and should have reached their equilibrium (that is the posterior density of the parameter under investigation).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coda_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coda.html">as_coda</a></span><span class="op">(</span><span class="va">chrono_events</span>, chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/autocorr.plot.html">autocorr.plot</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">[</span>,<span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/coda-autocor-1.png" width="576" style="display: block; margin: auto;"><img src="ArchaeoPhases_files/figure-html/coda-autocor-2.png" width="576" style="display: block; margin: auto;"><img src="ArchaeoPhases_files/figure-html/coda-autocor-3.png" width="576" style="display: block; margin: auto;"></p>
<p>The autocorrelation plots show that each of these three chains are not significant. That means that we actually generated a non correlated sample, which was the aim the MCMC process.</p>
<p>We can also check whether the chains reached equilibrium. For example, let’s consider the first date of the dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">[</span>, <span class="fl">1</span>, <span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/coda-plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The plot shows that the three chains corresponding to the first date reached the same stationnary process.</p>
<p>We can test the Gelman-Rubin criterion. The expected value to confirm that all of the Markov chains reached equilibrium is 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.diag.html">gelman.diag</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">)</span>
<span class="co">#&gt; Potential scale reduction factors:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Point est. Upper C.I.</span>
<span class="co">#&gt; [1,]          1          1</span></code></pre></div>
<p>The Gelman-Rubin criterion confirms that all of the Markov chains reached equilibrium. We can also test the Geweke criterion. The expected value to confirm that all of the Markov chains reached equilibrium is strickly less than 1.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/geweke.diag.html">geweke.diag</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">[</span>, <span class="fl">1</span>, <span class="op">]</span>, frac1 <span class="op">=</span> <span class="fl">0.1</span>, frac2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fraction in 1st window = 0.1</span>
<span class="co">#&gt; Fraction in 2nd window = 0.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    var1 </span>
<span class="co">#&gt; -0.9288 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fraction in 1st window = 0.1</span>
<span class="co">#&gt; Fraction in 2nd window = 0.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   var1 </span>
<span class="co">#&gt; 0.2023 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fraction in 1st window = 0.1</span>
<span class="co">#&gt; Fraction in 2nd window = 0.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   var1 </span>
<span class="co">#&gt; -1.583</span></code></pre></div>
<p>The Geweke criterion criterion confirms that all of the Markov chains reached equilibrium.</p>
<p>ChronoModel generated correct samples of the posterior distribution. Now gathering the three chains, a total of 30 000 iterations was collected in order to give estimations of the posterior distribution of each parameter.</p>
</div>
<div id="analysis-of-a-series-of-dates" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-a-series-of-dates" class="anchor"></a>Analysis of a series of dates</h1>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Be patient: the execution time depends on the number of dates included</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">chrono_events</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/event-plot-1.png" width="576" style="display: block; margin: auto;"></p>
<div id="tempo-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#tempo-plot" class="anchor"></a>Tempo Plot</h2>
<p>The tempo plot has been introduced by <span class="citation">Dye (2016)</span>. See <span class="citation">Philippe and Vibet (2020)</span> for more statistical details.</p>
<p>The tempo plot is one way to measure change over time: it estimates the cumulative occurrence of archaeological events in a Bayesian calibration. The tempo plot yields a graphic where the slope of the plot directly reflects the pace of change: a period of rapid change yields a steep slope and a period of slow change yields a gentle slope. When there is no change, the plot is horizontal. When change is instantaneous, the plot is vertical.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Warning: this may take a few seconds</span>
<span class="va">chrono_events</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/tempo.html">tempo</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/tempo-plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>From these graphs, we can see that the highest part of the sampled activity is dated between -45 000 to -35 000 but two dates are younger, at about -32 000 and -28 000.</p>
</div>
<div id="activity-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#activity-plot" class="anchor"></a>Activity Plot</h2>
<p>The activity plot displays the derivative of the Bayes estimate of the Tempo plot. It is an other way to see changes over time.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Warning: this may take a few seconds</span>
<span class="va">chrono_events</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/activity.html">activity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/activity-plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="occurrence-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#occurrence-plot" class="anchor"></a>Occurrence Plot</h2>
<p>The Occurrence plot calculates the calendar date <span class="math inline">\(t\)</span> corresponding to the smallest date such that the number of events observed before <span class="math inline">\(t\)</span> is equal to <span class="math inline">\(k\)</span>, for <span class="math inline">\(k = [(1, 16)]\)</span>. The Occurrence plot draws the credible intervals or the highest posterior density (HPD) region of those dates associated to a desired level of confidence.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Warning: this may take a few seconds</span>
<span class="va">chrono_events</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/occurrence.html">occurrence</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/occurrence-plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="analysis-of-groups-of-dates" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-groups-of-dates" class="anchor"></a>Analysis of groups of dates</h1>
<div id="groups-of-dates" class="section level2">
<h2 class="hasAnchor">
<a href="#groups-of-dates" class="anchor"></a>Groups of dates</h2>
<p>A group of dates is defined by the date of the minimum and the date of the maximum of the group. In this part, we will use the data containing these values for each group of dates.</p>
<p>We can estimate the time range of a group of dates as the shortest interval that contains all the dates of the group at a given confidence level <span class="citation">(Philippe and Vibet 2020)</span>.</p>
<p>The following code gives the endpoints of the time range of all groups of dates of Ksar Akil data at a given confidence level.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phases</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coerce.html">as_phases</a></span><span class="op">(</span><span class="va">chrono_phases</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">phases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EPI"</span>, <span class="st">"UP"</span>, <span class="st">"Ahmarian"</span>, <span class="st">"IUP"</span><span class="op">)</span>

<span class="fu"><a href="../reference/boundaries.html">boundaries</a></span><span class="op">(</span><span class="va">phases</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="co">#&gt;           start    end</span>
<span class="co">#&gt; EPI      -29071 -27102</span>
<span class="co">#&gt; UP       -38559 -29335</span>
<span class="co">#&gt; Ahmarian -42189 -37461</span>
<span class="co">#&gt; IUP      -43217 -41106</span></code></pre></div>
<p>The time range interval of the group of dates is a way to summarize the estimation of its minimum, the estimation of its maximum and their uncertainties at the same time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">phases</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="succession-of-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#succession-of-groups" class="anchor"></a>Succession of groups</h2>
<p>We may also be interested in a succession of phases. This is actually the case of the succession of <em>IUP</em>, <em>Ahmarian</em>, <em>UP</em> and <em>EPI</em> that are in stratigraphic order. Hence, we can estimate the transition interval and, if it exists, the gap between these successive phases.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_order</span><span class="op">(</span><span class="va">phases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IUP"</span>, <span class="st">"Ahmarian"</span>, <span class="st">"UP"</span>, <span class="st">"EPI"</span><span class="op">)</span>
<span class="fu"><a href="../reference/phase.html">get_order</a></span><span class="op">(</span><span class="va">phases</span><span class="op">)</span>
<span class="co">#&gt; [1] IUP      Ahmarian UP       EPI     </span>
<span class="co">#&gt; Levels: IUP &lt; Ahmarian &lt; UP &lt; EPI</span></code></pre></div>
<div id="transistions-between-successive-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#transistions-between-successive-groups" class="anchor"></a>Transistions between successive groups</h3>
<p>The transition interval between two successive phases is the shortest interval that covers the end of the oldest group of dates and the start of the youngest group of dates. The start and the end are estimated by the minimum and the maximum of the dates included in the group of dates. It gives an idea of the transition period between two successive group of dates. From a computational point of view this is equivalent to the time range calculated between the end of the oldest group of dates and the start of the youngest group of dates.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/transition.html">transition</a></span><span class="op">(</span><span class="va">phases</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="co">#&gt;                          start    end</span>
<span class="co">#&gt; IUP.beta-Ahmarian.alpha -43241 -40728</span>
<span class="co">#&gt; Ahmarian.beta-UP.alpha  -39075 -36686</span>
<span class="co">#&gt; UP.beta-EPI.alpha       -31504 -26960</span></code></pre></div>
</div>
<div id="gap-between-successive-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#gap-between-successive-groups" class="anchor"></a>Gap between successive groups</h3>
<p>Successive phases may also be separated in time. Indeed there may exist a gap between them. This testing procedure check whether a gap exists between two successive groups of dates with fixed probability. If a gap exists, it is an interval that covers the end of one group of dates and the start of the successive one with fixed posterior probability.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/hiatus.html">hiatus</a></span><span class="op">(</span><span class="va">phases</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="co">#&gt;                          start    end</span>
<span class="co">#&gt; IUP.beta-Ahmarian.alpha     NA     NA</span>
<span class="co">#&gt; Ahmarian.beta-UP.alpha      NA     NA</span>
<span class="co">#&gt; UP.beta-EPI.alpha       -29180 -28977</span></code></pre></div>
<p>At a confidence level of 95%, there is no gap between the succession of phases <em>IUP</em>, <em>Ahmarian</em> and <em>UP</em>, but there exists one of 203 years between phase <em>UP</em> and phase <em>EPI</em>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">phases</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ArchaeoPhases_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-bosch2015">
<p>Bosch, M. D., M. A. Mannino, A. L. Prendergast, T. C. O’Connell, B. Demarchi, S. M. Taylor, L. Niven, J. van der Plicht, and J.-J. Hublin. 2015. “New Chronology for Ksâr ’Akil (Lebanon) Supports Levantine Route of Modern Human Dispersal into Europe.” <em>Proceedings of the National Academy of Sciences</em> 112 (25): 7683–8. <a href="https://doi.org/10.1073/pnas.1501529112">https://doi.org/10.1073/pnas.1501529112</a>.</p>
</div>
<div id="ref-bronkramsey2009">
<p>Bronk Ramsey, C. 2009. “Bayesian Analysis of Radiocarbon Dates.” <em>Radiocarbon</em> 51 (1): 337–60. <a href="https://doi.org/10.1017/S0033822200033865">https://doi.org/10.1017/S0033822200033865</a>.</p>
</div>
<div id="ref-buck1999">
<p>Buck, C. E., J. A. Christen, and G. E. James. 1999. “BCal: An on-Line Bayesian Radiocarbon Calibration Tool.” <em>Internet Archaeology</em> 7. <a href="https://doi.org/10.11141/ia.7.1">https://doi.org/10.11141/ia.7.1</a>.</p>
</div>
<div id="ref-dye2016">
<p>Dye, T. S. 2016. “Long-Term Rhythms in the Development of Hawaiian Social Stratification.” <em>Journal of Archaeological Science</em> 71: 1–9. <a href="https://doi.org/10.1016/j.jas.2016.05.006">https://doi.org/10.1016/j.jas.2016.05.006</a>.</p>
</div>
<div id="ref-lanos2020">
<p>Lanos, Ph., A. Philippe, H. Lanos, and Ph. Dufresne. 2020. <em>Chronomodel: Chronological Modeling of Archaeological Data Using Bayesian Statistics</em>. <a href="https://www.chronomodel.fr">https://www.chronomodel.fr</a>.</p>
</div>
<div id="ref-philippe2020">
<p>Philippe, A., and M.-A. Vibet. 2020. “Analysis of Archaeological Phases Using the R Package Archaeophases.” <em>Journal of Statistical Software, Code Snippets</em> 93 (1): 1–25. <a href="https://doi.org/10.18637/jss.v093.c01">https://doi.org/10.18637/jss.v093.c01</a>.</p>
</div>
<div id="ref-robert2010">
<p>Robert, C. P., and G. Casella. 2010. <em>Introducing Monte Carlo Methods with R</em>. Use R! New York: Springer.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anne Philippe, Marie-Anne Vibet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
